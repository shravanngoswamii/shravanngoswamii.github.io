<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Climbing Man Back to Top</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        :root {
            --climber-color: #000000;
            --rope-color: rgba(0,0,0,0.1);
        }

        .dark {
            --climber-color: #ffffff;
            --rope-color: rgba(255,255,255,0.1);
        }

        /* Visibility and interaction transitions */
        .climber-btn {
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1), visibility 0.4s, transform 0.2s;
            visibility: hidden;
            opacity: 0;
            background: transparent;
            border: none;
            padding: 0;
            cursor: pointer;
        }

        .climber-btn.visible {
            visibility: visible;
            opacity: 1;
        }

        .climber-svg {
            width: 60px;
            height: 90px;
        }

        /* Rope Animation */
        .rope-bg {
            stroke: var(--rope-color);
            stroke-width: 1.5;
        }
        
        .rope-thread {
            stroke: var(--climber-color);
            stroke-width: 2.5;
            stroke-dasharray: 10 10;
        }

        /* Climbing: Rope moves down */
        .is-climbing .rope-thread {
            animation: rope-feed-up 0.4s linear infinite;
        }

        /* Descending: Rope moves up */
        .is-descending .rope-thread {
            animation: rope-feed-down 0.4s linear infinite;
        }

        @keyframes rope-feed-up {
            from { stroke-dashoffset: 0; }
            to { stroke-dashoffset: -20; }
        }

        @keyframes rope-feed-down {
            from { stroke-dashoffset: -20; }
            to { stroke-dashoffset: 0; }
        }

        /* Sprite Frame Logic */
        .pose { 
            opacity: 0;
            stroke: var(--climber-color); 
            fill: none; 
            stroke-width: 5; 
            stroke-linecap: round; 
            stroke-linejoin: round;
        }
        
        .hand { fill: var(--climber-color); stroke: none; }
        .head { fill: var(--climber-color); stroke: none; }

        /* Climbing Cycle (4 Frames) */
        .is-climbing .pose-1 { animation: frame-seq 0.8s steps(1) infinite; animation-delay: 0s; }
        .is-climbing .pose-2 { animation: frame-seq 0.8s steps(1) infinite; animation-delay: 0.2s; }
        .is-climbing .pose-3 { animation: frame-seq 0.8s steps(1) infinite; animation-delay: 0.4s; }
        .is-climbing .pose-4 { animation: frame-seq 0.8s steps(1) infinite; animation-delay: 0.6s; }

        /* Descending Pose (Single Frame Rappel) */
        .is-descending .pose-descend { opacity: 1; }

        @keyframes frame-seq {
            0%, 24.9% { opacity: 1; }
            25%, 100% { opacity: 0; }
        }

        /* Idle State Styling */
        .climber-btn:not(.is-climbing):not(.is-descending) .pose-idle { opacity: 1; }

        /* Physics Dynamics */
        .is-climbing .man-group {
            animation: climb-physics 0.4s ease-in-out infinite alternate;
            transform-origin: center top;
        }

        .is-descending .man-group {
            animation: descend-physics 0.4s ease-in-out infinite alternate;
            transform-origin: center top;
        }

        @keyframes climb-physics {
            0% { transform: translateY(0) translateX(-2px) rotate(-2deg); }
            100% { transform: translateY(-10px) translateX(2px) rotate(2deg); }
        }

        @keyframes descend-physics {
            0% { transform: translateY(0) scaleY(1); }
            100% { transform: translateY(5px) scaleY(0.98); }
        }
    </style>
</head>
<body class="bg-zinc-50 dark:bg-zinc-950 text-zinc-900 dark:text-zinc-100 transition-colors duration-500 min-h-screen">

    <div class="fixed top-6 right-6 z-50">
        <button id="themeToggle" class="p-3 rounded-2xl bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 shadow-xl hover:scale-110 active:scale-95 transition-all">
            <svg id="sunIcon" class="w-6 h-6 hidden dark:block text-amber-500" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/></svg>
            <svg id="moonIcon" class="w-6 h-6 block dark:hidden text-zinc-400" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"/></svg>
        </button>
    </div>

    <main class="max-w-xl mx-auto py-32 px-10">
        <header class="mb-20">
            <h1 class="text-6xl font-black uppercase tracking-tighter mb-4">Ascend</h1>
            <p class="text-xl opacity-40 italic">Scroll up to climb, down to slide.</p>
        </header>

        <div class="space-y-60 opacity-10">
            <div class="h-40 border-l-4 border-zinc-400 dark:border-zinc-700 ml-4"></div>
            <div class="h-40 border-l-4 border-zinc-400 dark:border-zinc-700 ml-4"></div>
            <div class="h-40 border-l-4 border-zinc-400 dark:border-zinc-700 ml-4"></div>
            <div class="h-40 border-l-4 border-zinc-400 dark:border-zinc-700 ml-4"></div>
        </div>
    </main>

    <button id="backToTop" class="climber-btn fixed bottom-10 right-10 z-50 hover:scale-105" aria-label="Return to top">
        <svg class="climber-svg" viewBox="0 0 100 135">
            <line x1="50" y1="0" x2="50" y2="132" class="rope-bg" />
            <line x1="50" y1="0" x2="50" y2="132" class="rope-thread" />
            
            <g class="man-group">
                <!-- Idle Frame -->
                <g class="pose pose-idle">
                    <circle cx="50" cy="55" r="7" class="head"/>
                    <path d="M50 62 L50 85" />
                    <path d="M50 62 L38 50 L50 38" /> 
                    <path d="M50 62 L62 62 L50 60" /> 
                    <circle cx="50" cy="38" r="3.5" class="hand" /> 
                    <circle cx="50" cy="60" r="3.5" class="hand" /> 
                    <path d="M50 85 L40 95 L48 110" /> 
                    <path d="M50 85 L62 100 L55 120" /> 
                </g>

                <!-- Descending Frame (Rappel) -->
                <g class="pose pose-descend">
                    <circle cx="50" cy="52" r="7" class="head"/>
                    <path d="M50 59 L50 82" />
                    <path d="M50 60 L38 55 L50 52" /> 
                    <path d="M50 60 L62 55 L50 52" /> 
                    <circle cx="50" cy="52" r="3.5" class="hand" /> 
                    <path d="M50 82 L42 105 L35 110 M50 82 L58 105 L65 110" /> 
                </g>

                <!-- Frame 1: Reach Right High -->
                <g class="pose pose-1">
                    <circle cx="50" cy="55" r="7" class="head"/>
                    <path d="M50 62 L50 90" />
                    <circle cx="50" cy="15" r="4" class="hand" />
                    <path d="M50 62 L65 35 L50 15" /> 
                    <circle cx="50" cy="68" r="4" class="hand" />
                    <path d="M50 62 L35 75 L50 75" /> 
                    <path d="M50 90 L38 95 L30 120" />
                    <path d="M50 90 L62 95 L55 105" />
                </g>

                <!-- Frame 2: Power Pull -->
                <g class="pose pose-2">
                    <circle cx="50" cy="48" r="7" class="head"/>
                    <path d="M50 55 L50 83" />
                    <circle cx="50" cy="35" r="4" class="hand" />
                    <path d="M50 55 L35 45 L50 35" />
                    <path d="M50 55 L65 45 L50 35" />
                    <path d="M50 83 L40 95 L50 105" />
                    <path d="M50 83 L60 95 L50 105" />
                </g>

                <!-- Frame 3: Reach Left High -->
                <g class="pose pose-3">
                    <circle cx="50" cy="55" r="7" class="head"/>
                    <path d="M50 62 L50 90" />
                    <circle cx="50" cy="15" r="4" class="hand" />
                    <path d="M50 62 L35 35 L50 15" /> 
                    <circle cx="50" cy="68" r="4" class="hand" />
                    <path d="M50 62 L65 75 L50 75" /> 
                    <path d="M50 90 L62 95 L70 120" /> 
                    <path d="M50 90 L38 95 L45 105" /> 
                </g>

                <!-- Frame 4: Power Pull Secondary -->
                <g class="pose pose-4">
                    <circle cx="50" cy="48" r="7" class="head"/>
                    <path d="M50 55 L50 83" />
                    <circle cx="50" cy="35" r="4" class="hand" />
                    <path d="M50 55 L35 45 L50 35" />
                    <path d="M50 55 L65 45 L50 35" />
                    <path d="M50 83 L40 95 L50 105" />
                    <path d="M50 83 L60 95 L50 105" />
                </g>
            </g>
        </svg>
    </button>

    <script>
        /**
         * Logic for the climbing man "Back to Top" component.
         * Detects scroll direction to trigger climbing (up) or descending (down) animations.
         */
        const btn = document.getElementById('backToTop');
        const themeBtn = document.getElementById('themeToggle');
        let scrollTimer;
        let lastPos = window.pageYOffset;

        // Theme Toggle Functionality
        themeBtn.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Scroll Monitoring
        window.addEventListener('scroll', () => {
            const currentPos = window.pageYOffset || document.documentElement.scrollTop;

            // Visibility Logic
            if (currentPos > 300) {
                btn.classList.add('visible');
            } else {
                btn.classList.remove('visible');
            }

            // Direction and Animation Logic
            if (currentPos < lastPos && currentPos > 5) {
                // Scrolling Up: Climbing
                btn.classList.add('is-climbing');
                btn.classList.remove('is-descending');
            } else if (currentPos > lastPos) {
                // Scrolling Down: Descending
                btn.classList.add('is-descending');
                btn.classList.remove('is-climbing');
            } else {
                btn.classList.remove('is-climbing', 'is-descending');
            }

            // Clear states when scrolling stops
            clearTimeout(scrollTimer);
            scrollTimer = setTimeout(() => {
                btn.classList.remove('is-climbing', 'is-descending');
            }, 120);

            lastPos = currentPos <= 0 ? 0 : currentPos;
        }, { passive: true });

        // Smooth Scroll to Top
        btn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>